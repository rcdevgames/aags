// Generated by CoffeeScript 1.6.3
(function() {
  var PngAnimator;

  PngAnimator = function(element, auto_start) {
    var frame, frames, height, is_loaded, loader;
    element = $(element);
    loader = $(document.createElement('IMG')).css({
      display: 'none'
    });
    is_loaded = false;
    frame = 0;
    frames = element.data('frames');
    height = element.data('animation-height');
    loader.on('load', function() {
      element.css({
        backgroundImage: 'url(' + loader.attr('src') + ')'
      });
      return is_loaded = true;
    });
    loader.attr('src', element.data('animation'));
    element.css({
      width: element.data('animation-width'),
      height: height
    });
    $(document.body).append(loader);
    return setInterval(function() {
      if (!is_loaded) {
        return;
      }
      element.css({
        backgroundPosition: "left -" + (frame * height) + "px"
      });
      frame++;
      if (frame > frames - 4) {
        return frame = 0;
      }
    }, element.data('animation-interval') || 50);
  };

  $('.anipng').each(function() {
    return new PngAnimator(this);
  });

}).call(this);
